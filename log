    @Test
    void testValidAuthRequest_InvalidTokenType() {
        // Create a mock TokenRequest with an invalid token type
        TokenRequest invalidTokenRequest = mock(TokenRequest.class);
        when(invalidTokenRequest.getTokenType()).thenReturn(null); // Simulating an unexpected/null token type

        // Expect an EPaySecurityException due to invalid token type
        EPaySecurityException exception = assertThrows(EPaySecurityException.class, () -> {
            AuthRequestValidator.validAuthRequest(invalidTokenRequest);
        });

        // Verify the error message and code
        assertFalse(exception.getErrorMessage().isEmpty());
        assertEquals(EPayAuthenticationErrorConstants.INVALID_ERROR_CODE, exception.getErrorMessages().getFirst().getErrorCode());
        assertEquals(
                MessageFormat.format(EPayAuthenticationErrorConstants.INVALID_ERROR_MESSAGE, "TOKEN_TYPE"),
                exception.getErrorMessage());

    }

Cannot invoke "com. sbi. epay. authentication. util. enums. TokenType. ordinal()" because the return value of "com. sbi. epay. authentication. model. TokenRequest. getTokenType()" is nul
