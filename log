@Service
@RequiredArgsConstructor
public class AuthenticationUserDetailsService {

    private final AuthenticationUserService userService;

    public UserDetailsService userDetailsService() {
        return username -> userService.loadUserByUserName(username).orElseThrow(() -> new EPaySecurityException(EPayAuthenticationErrorConstants.NOT_FOUND_ERROR_CODE, MessageFormat.format(EPayAuthenticationErrorConstants.NOT_FOUND_ERROR_MESSAGE, EPayAuthenticationErrorConstants.USER_NAME)));
    }
}
public interface AuthenticationUserService {
    Optional<EPayPrincipal> loadUserByUserName(String userName);

    boolean isTokenInValid(String token, String tokenType);
}
